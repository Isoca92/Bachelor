\section{Evaluation}
\subsection{Testen}\label{ssec:test}
Zur Überprüfung der Korrektheit des implementierten Verfahrens \textit{SmartsSmarts} wurden im ersten Schritt der Evaluation die Hauptfunktionen, die das Verfahren nutzt, auf korrekte Ergebnisse überprüft. Welche Testfunktionen genutzt wurden wird in diesem Kapitel beschrieben.

\begin{description}
\item[\texttt{fingerprint:}]\hfill \\
Die Testfunktion prüft, ob bei der Übergaben von einem Knoten eines SMARTS-Ausdrucks ein Fingerprint generiert wurde, der die richtigen Bits gesetzt hat.

\item[\texttt{mapping:}]\hfill \\
Überprüft die Korrektheit der Funktion bei der anhand von zwei Fingerprints und einer Teilmengen-Relation ermittelt wird, ob die gewünschte Teilmengen-Relation gefunden wurde.

\item[\texttt{nodeRelationMatrix:}]\hfill \\
Initialisiert eine Relations-Matrix und überprüft, ob diese korrekt erstellt wurde.

\item[\texttt{smartsSmartsUllmann:}]\hfill \\
Testfunktion die ermittelt, ob bei der Übergabe von zwei SMARTS-Ausdrücken und einer Teilmengen-Relation das erwartete \textit{Mapping} in Form einer Permutationsmatrix ausgegeben wird.

\end{description}

Durch die Testfunktionen konnten Fehler in der Finerprintgenerierung und der Isomorphismusanalyse durch den Algorithmus nach Ullmann identifiziert und behoben werden.

\subsection{Validierung}\label{ssec:validierung}
Nachdem die Korrektheit der einzelnen Funktionen getestet wurde, erfolgte anschließende eine Validierung des implementierten Verfahrens.

Die Validierung erfolgt dabei über den Vergleich von Molekülmengen. Es wurden 6~000 Moleküle aus der ZINC-Datenbank \cite{zinc} genutzt (siehe Anhang \ref{ssec:zinc}).\\
Die genutzten SMARTS-Ausdrücke \cite{smartsdata} wurden vom Zentrum für Bioinformatik veröffentlicht. Der Datensatz beinhaltet 1~469 SMARTS-Ausdrücke (siehe Anhang \ref{ssec:aasmarts}).

\subsubsection{Durchführung}
Das implementierte Verfahren wurde validiert indem die Molekülmengen der SMARTS-Ausdrücken verglichen wurden.
Das Vorgehen gliedert sich dabei in zwei Schritte.\\
Im ersten Schritt wird für zwei SMARTS-Ausdrücke und einer Teilmengen-Relation über-\\prüft, ob ein \textit{Mapping} gefunden wurde.\\
Schritt zwei überprüft das Verhalten von Anfrage- und Ziel-SMARTS im Bezug auf das Treffen (\textit{Matching}) von Molekülen. Wenn ein \textit{Mapping} gefunden wird, wird über die Molekülliste iteriert und geprüft ob Anfrage- und Ziel-SMARTS ihrer Teilmengen-Relation entsprechend das gleiche Molekül treffen. Tabelle \ref{tab:validierung} zeigt welche Bedingungen für welche Teilmengen-Relation erfüllt sein muss.\\

\begin{table}[h]
	\centering
	\captionabove{Übersicht der Bedinungen, die die SMARTS-Ausdrücke eines \textit{Mappings} erfüllen müssen, um für eine Teilmengen-Relation als valides \textit{Mapping} zu gelten. Betrachtet werden dabei die Teilmengen-Relationen Gleichheit, Untermenge und Obermenge.}
	\begin{tabular}{| c | l |}
		\hline Teilmengen-Relation & Bedingung des \textit{Matchings}\\
		\hline Gleichheit ($=$) & Anfrage-SMARTS und Ziel-SMARTS\\
		& müssen gleiches Molekül treffen\\
		Untermenge ($\subseteq$) &   Wenn Anfrage-SMARTS Molekül trifft,\\
		& muss auch Ziel-SMARTS treffen\\
		Obermenge ($\supseteq$) &   Wenn Ziel-SMARTS Molekül trifft,\\
		& muss auch Anfrage-SMARTS treffen\\ \hline
	\end{tabular}
	\label{tab:validierung}
\end{table}

Falls kein \textit{Mapping} gefunden wird, wird ebenfalls über die Molekülliste iteriert und für jedes Molekül geprüft, ob beide SMARTS-Ausdrücken das zu überprüfende Molekül treffen. Ist dies der Fall werden die beiden SMARTS-Ausdrücke zusammen mit der Teilmengen-Relation ausgegeben, um manuell ausschließen zu können, dass ein \textit{Mapping} nicht gefunden wurde. Solch ein Fall tritt auf, wenn innerhalb eines Moleküls unterschiedliche Atome durch den SMARTS-Ausdruck beschrieben werden.

Die Schnitt-Relation kann mit dieser Methode nicht validiert werden, da nicht gewährleistet ist, dass der Teil des Schnittes des gefundenen \textit{Mappings} ein Molekül trifft. Bei Beispiel \ref{bsp:validschnitt} und Abbildung \ref{abb:thyroxin} tritt der Fall ein, dass anhand der Molekülmenge eine Validierung nicht möglich ist. Beispiel \ref{bsp:validschnitt} zeigt ein \textit{Mapping} der Schnitt-Relation, wird nun das \textit{Matching}-Verhalten der beiden SMARTS-Ausdrücke in Bezug auf das Molekül aus Abbildung \ref{abb:thyroxin} verglichen, wird festgestellt, dass trotz eines gefundenen \textit{Mappings} die Molekülmenge nicht vergleichbar ist.\\

\begin{bsp}
	\label{bsp:validschnitt}
\end{bsp}
\begin{table}[h]
	\centering
	\begin{tabular}{l l | l}
		\textbf{Schnitt-\textit{Mapping}:} & Anfrage-SMARTS & \texttt{[Cl,I:1]}$\sim$\texttt{[c:2]}\\
		& Ziel-SMARTS & \texttt{[Cl,F:1]}$\sim$\texttt{[c:2]}\\
	\end{tabular}
\end{table}

\begin{figure}[h]
	\centering
	\includegraphics[width=5cm]{images/thyroxin}
	\caption{Levothyroxin mit grün gekenntzeichneten Teilstrukturen, bei denen der Anfrage-SMARTS das Molekül trifft \cite{thyroxin}}
	\label{abb:thyroxin}
\end{figure}

\newpage
\subsubsection{Resultate}
Durch die Validierung konnte ein Fehler aufgedeckt werden, bei dem das Anhängen der \textit{Label} im Vorverarbeitungsschritt (siehe Kapitel \ref{ssec:vorverarbeitung}) fehlschlug. Dieser Fehler hat die Ausführung des Verfahrens verhindert. Dieser wurde bei den Tests (siehe Kapitel \ref{ssec:test}) nicht aufgedeckt, da er nur bei einer Kombination aus aromatischen Elementnamen (z.B. \texttt{c}) mit Elementnamen bestehend aus zwei Zeichen (z.B. \texttt{Br}) auftritt.\\
Ein weiteres Fehlverhalten betrifft den zweiten Fall bei dem eine Schnitt-Relation festgestellt werden kann (siehe Kapitel \ref{ssec:relmatr} Gleichung \eqref{eq:fall2}). Dieser Fall wurde durch die Validierung kenntlich gemacht.

Nachdem die beschriebenen Probleme gelöst wurden, war es möglich die Validierung erfolgreich durchzuführen. Bei einem Beispiel des Validierungsverfahrens wurde als Anfrage-SMARTS \texttt{N$\sim$[\#6]} zusammen mit der Angabe, dass alle vier Teilmengen-Relationen an das Programm \textit{SmartsSmarts} übergeben. Als Ziel-SMARTS wurden die SMARTS-Ausdrücke als Liste übergeben. 431 SMARTS-Ausdrücke konnten von dem Programm nicht verarbeiten werden (siehe Kapitel \ref{ssec:probleme}).
Es wurden 4 Untermengen-\textit{Mappings} und 109 Obermengen-\textit{Mappings} gefunden, welche alle durch die Validierung bestätigt werden konnten. Die Fälle, bei denen ohne \textit{Mapping} dennoch beide SMARTS-Ausdrücke ein Molekül getroffen wurden, wurden wie beschrieben manuell überprüft. Es konnte kein fehlendes \textit{Mapping} festgestellt werden.\\
Neben diesem Beispiel wurde die Validierung mehrfach mit unterschiedlichen Anfrage-SMARTS erfolgreich durchgeführt.

\newpage
\subsection{Laufzeitanalyse}
Für die Laufzeitanalyse wurde die benötigte Zeit des Verfahrens in Zusammenhang mit der Größe der genutzten SMARTS-Ausdrücke gebracht. Durchgeführt wurde die Laufzeitanalyse auf einem Rechner mit Intel\textregistered~Core\texttrademark~7-3770S CPU 3.10GHz. Dabei ist zu beachten, dass nebenläufige Prozesse nicht ausgeschlossen werden können.

Abbildung \ref{abb:laufzeitgleich} zeigt, wie sich die Laufzeit (in Sekunden) bei Anstieg der Knotenanzahl von Anfrage- und Ziel-SMARTS verhält. Diese Form der Laufzeitanalyse ist für alle vier Teilmengen-Relationen möglich. Schwankungen der Laufzeit sind auf die Komplexität der SMARTS-Ausdrücke zurückzuführen. Je verzweigter die Graphenstruktur ist, desto länger dauert der Aufbau der Relations-Matrix. Deutlich ist zu erkennen, dass die Schnitt-Relation in etwa die doppelte Zeit benötigt. Das liegt daran, dass anschließend an die Untersuchung auf einen Isomorphismus durch den Algorithmus nach Ullmann wiederholt die Schnitt-Relation überprüft.

\begin{figure}[h!]
	\centering
	\includegraphics[width=13cm]{images/Laufzeit_gleich}
	\caption{Auftragung der Laufzeit in Sekunden, gegen Anzahl der Knoten eines SMARTS-Ausdrucks, wobei Anfrage- und Ziel-SMARTS die gleiche Größe besitzen. Jede Kurve repräsentiert eine Teilmengen-Relation.}
	\label{abb:laufzeitgleich}
\end{figure}

Für die Unter- und Obermenge lässt sich der Fall untersuchen, bei dem die Knoten-Anzahl der SMARTS-Ausdrücke unabhängig voneinander variiert. Abbildung \ref{abb:laufzeitwachs} verdeutlicht den Laufzeitanstieg (in Sekunden) bei einer ansteigenden Größe der Anfrage-SMARTS zusammen mit einer gleichbleibenden Größe der Ziel-SMARTS. Die Größe der gleichbleibenden SMARTS-Ausdrücke liegt bei einer Überprüfung auf eine Untermengen-Relation konstant bei einem Knoten. Wird auf eine Obermengen-Relation geprüft, so sind die SMARTS-Ausdrücke konstant bei einer Länge von 21 Knoten.

\newpage
\begin{figure}[h!]
	\centering
	\includegraphics[width=13cm]{images/laufzeit_wachsend}
	\caption{Auftragung der Laufzeit in Sekunden, gegen Anzahl der Knoten des Ziel-SMARTS. Der Anfrage-SMARTS besteht konstant auf einem (Untermenge) bzw. konstant auf 21 (Obermenge) Knoten.}
	\label{abb:laufzeitwachs}
\end{figure}

\vspace{0.5cm}
Diese Laufzeitanalyse lässt  visuell auf eine lineare oder quadratische Laufzeit schließen. Der genutzte Algorithmus nach Ullmann benötigt im schlimmsten Fall, bei einem Anfrag-SMARTS mit Knotenanzahl $n$ und einem Ziel-SMARTS mit Knotenanzahl $m$, eine Laufzeit, die in $\mathcal{O}(m^nn^2)$ liegt. Bei dem Aufbau der Relations-Matrix werden $nm$ Vergleiche, und bei dem Aufbau der Kanten-Verträglichkeit $(n-1)(m-1)$ Vergleiche benötigt. Letztendlich liegt die Laufzeit des entwickelten Verfahrens im schlimmsten Fall in $\mathcal{O}(m^nn^2)$.
%
% EOF
%